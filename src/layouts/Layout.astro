---
interface Props {
	title: string;
}

const { title } = Astro.props;
import '../styles/global.css';
import LanguagePicker from '../components/LanguagePicker.astro';
import ThemeToggle from '../components/ThemeToggle.astro';
---

<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="description" content="SudoFix - Database of Common Python Errors" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<title>{title} | SudoFix</title>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
        <script is:inline>
            // Check for saved theme preference or use system preference
            const theme = (() => {
                if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
                    return localStorage.getItem('theme');
                }
                if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    return 'dark';
                }
                return 'light';
            })();
            
            if (theme === 'dark') {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
            
            window.localStorage.setItem('theme', theme);

            // Copy to Clipboard Script
            document.addEventListener('DOMContentLoaded', () => {
                const codeBlocks = document.querySelectorAll('pre');

                codeBlocks.forEach((codeBlock) => {
                    // Create copy button
                    const copyButton = document.createElement('button');
                    copyButton.className = 'absolute top-2 right-2 text-gray-400 hover:text-white bg-gray-700/50 hover:bg-gray-700 rounded p-1 text-xs opacity-0 group-hover:opacity-100 transition-all';
                    copyButton.innerHTML = `
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                    `;
                    copyButton.ariaLabel = 'Copy code';

                    // Wrap pre in relative group container if not already
                    const wrapper = document.createElement('div');
                    wrapper.className = 'relative group';
                    codeBlock.parentNode.insertBefore(wrapper, codeBlock);
                    wrapper.appendChild(codeBlock);
                    wrapper.appendChild(copyButton);

                    // Copy logic
                    copyButton.addEventListener('click', async () => {
                        const code = codeBlock.querySelector('code')?.innerText || codeBlock.innerText;
                        try {
                            await navigator.clipboard.writeText(code);
                            copyButton.innerHTML = `<svg class="w-4 h-4 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>`;
                            setTimeout(() => {
                                copyButton.innerHTML = `
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                                `;
                            }, 2000);
                        } catch (err) {
                            console.error('Failed to copy!', err);
                        }
                    });
                });
            });
        </script>
	</head>
	<body class="bg-white text-gray-900 dark:bg-gray-950 dark:text-gray-100 min-h-screen flex flex-col font-sans antialiased transition-colors duration-300">
        <div class="border-b border-gray-200 dark:border-gray-800 sticky top-0 bg-white/80 dark:bg-gray-950/80 backdrop-blur-md z-10 transition-colors duration-300">
            <nav class="max-w-4xl mx-auto px-4 h-16 flex items-center justify-between">
                <a href="/" class="text-xl font-bold font-mono tracking-tighter text-gray-900 dark:text-gray-100">
                    <span class="text-blue-600 dark:text-blue-500">sudo</span>fix
                </a>
                <div class="flex items-center gap-4 text-sm font-medium">
                    <LanguagePicker currentLocale={Astro.currentLocale} />
                    <ThemeToggle />
                    <a href="#python" class="hidden sm:block text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 transition-colors">Python</a>
                    <a href="#javascript" class="hidden sm:block text-gray-500 hover:text-yellow-600 dark:text-gray-400 dark:hover:text-yellow-400 transition-colors">JavaScript</a>
                    <a href="https://github.com/sudofix/db" target="_blank" class="text-gray-400 hover:text-gray-900 dark:hover:text-gray-200">
                        <svg viewBox="0 0 24 24" class="w-5 h-5" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 4.438 9.8 9.958 10.521 1.259.444 1.549-.365 1.549-1.003 0-.649-.033-2.903-.04-5.006-4.665 1.838-5.748-2.618-5.748-2.618-1.077-2.695-2.661-3.327-2.661-3.327-1.524-.968.125-.972.125-.972 1.685.111 2.585 1.636 2.585 1.636 1.498 2.443 3.931 1.737 4.891 1.328.152-1.033.585-1.737 1.066-2.137-3.725-.398-7.641-1.776-7.641-7.907 0-1.747.653-3.036 1.618-4.148-.204-.492-.81-2.457.067-4.629 0 0 1.419-.43 4.652 1.69 1.348-.354 2.805-.533 4.263-.533 1.458 0 2.915.179 4.263.533 3.231-2.122 4.65-1.69 4.65-1.69.879 2.172.274 4.137.07 4.629.967 1.111 1.616 2.401 1.616 4.148 0 6.143-3.921 7.506-7.655 7.901.625.518 1.139 1.464 1.139 2.923 0 2.109-.021 3.804-.021 4.316 0 .641.288 1.454 1.558 1.001 5.516-.723 9.948-5.219 9.948-10.519 0-6.627-5.374-12-12-12z"/></svg>
                    </a>
                </div>
            </nav>
        </div>

		<slot />

        <footer class="border-t border-gray-200 dark:border-gray-800 mt-auto bg-gray-50 dark:bg-gray-900/50">
            <div class="max-w-4xl mx-auto px-4 py-8 text-center text-sm text-gray-500">
                <p>&copy; {new Date().getFullYear()} SudoFix. Built for Developers.</p>
            </div>
        </footer>
	</body>
</html>
<style is:global>
	:root {
		--accent: 37, 99, 235;
	}
    body {
        font-family: 'Inter', system-ui, sans-serif;
    }
    code, pre, .font-mono {
        font-family: 'JetBrains Mono', monospace;
    }
</style>
